from collections import defaultdict

a = [{'Filename': 'Carrier-AXA Risk-LIA Cover-EL | BDX May w_denis.xlsx', 'month_year': '[5, 2023]', 'excel_file_path': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/s1_map_udf/Carrier-AXA Risk-LIA Cover-EL | BDX May w_denis.xlsx', 'bdx_type': 'w_denis_custodian_office_el', '__config': '{"scheme": "W Denis Custodian Office", "i90_policy_name": "W Denis Custodian Office", "lead_underwriter": "Sabria T", "policy_number": "6930677", "read_excel": {"skiprows": [], "merge_rows": {}, "tolerance_nan_count": 23, "primary_columns": ["Total Annual Prem"], "target_header_values": ["Total Premium"]}, "columns_mapping": {"column_1": "Total Premium", "column_2": "Total Commission", "column_3": "IPT"}, "validations": {"ipt_pct": {"field": "ipt_pct", "type": "formula", "formula": "column_3/column_1", "allowed_values": [0, 0.12], "tolerance": 0.002, "error_message": "IPT Validations has failed as percentage does not equal 0 % or 12 %"}, "policy_number": {"field": "policy_number", "type": "value_in_list", "allowed_values": ["6930677"], "error_message": "Following rows are invalid for  Policy Number"}, "commission_pct": {"field": "column_2", "type": "formula", "formula": "(column_2/column_1)*100", "comparison": "greater_than", "allowed_values": [37.0], "error_message": " Commission % is greater than 37% in the following rows"}}, "output_mapping": {"sum": ["column_1", "column_2"], "column_mapping_names": {"ipt_column_name": "ipt_pct", "policy_number": "policy_number"}, "transaction_dependant": [], "seperate_values_columns": [], "formulas": {"commission_pct": "(column_2/column_1)*100"}, "mapping": {"column_1": ["AE"], "column_2": ["AD"], "commission_pct": ["AC"]}, "custom_formulas": {}, "combine_terrorism": []}, "terrorism_rates": {}}', 'columns_mapping_link': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/AXA/column_mapping.json', 'columns_mapping': '[["Name", "Original Name"], ["column_1", "Total Premium"], ["column_2", "Total Commission"], ["column_3", "IPT"]]', 'scheme': 'W Denis Custodian Office', 'column_1': '[150, 188]', 'policy_name': '["W Denis Custodian Office", "W Denis Custodian Office"]', 'policy_number': '["6930677", "6930677"]', 'column_2': '[55.5, 69.56]', 'column_3': '[18.0, 22.56]', 'ipt_pct': '[0.12, 0.12]'}, {'Filename': 'Carrier-AXA Risk-LIA Cover-PL | BDX May w_denis.xlsx', 'month_year': '[5, 2023]', 'excel_file_path': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/s1_map_udf/Carrier-AXA Risk-LIA Cover-PL | BDX May w_denis.xlsx', 'bdx_type': 'w_denis_custodian_office_pl', '__config': '{"scheme": "W Denis Custodian Office", "i90_policy_name": "W Denis Custodian Office", "lead_underwriter": "Sabria T", "policy_number": "6930677", "read_excel": {"skiprows": [], "merge_rows": {}, "tolerance_nan_count": 23, "primary_columns": ["Posted Date"], "target_header_values": ["Total Premium"]}, "columns_mapping": {"column_1": "Total Premium", "column_2": "Total Commission", "column_3": "IPT"}, "validations": {"ipt_pct": {"field": "ipt_pct", "type": "formula", "formula": "column_3/column_1", "allowed_values": [0, 0.12], "tolerance": 0.002, "error_message": "IPT Validations has failed as percentage does not equal 0 % or 12 %"}, "policy_number": {"field": "policy_number", "type": "value_in_list", "allowed_values": ["6930677"], "error_message": "Following rows are invalid for  Policy Number"}, "commission_pct": {"field": "column_2", "type": "formula", "formula": "(column_2/column_1)*100", "comparison": "greater_than", "allowed_values": [37.0], "error_message": " Commission % is greater than 37% in the following rows"}}, "output_mapping": {"sum": ["column_1", "column_2"], "column_mapping_names": {"ipt_column_name": "ipt_pct", "policy_number": "policy_number"}, "transaction_dependant": [], "seperate_values_columns": [], "formulas": {"commission_pct": "(column_2/column_1)*100"}, "mapping": {"column_1": ["AH"], "column_2": ["AG"], "commission_pct": ["AF"]}, "custom_formulas": {}, "combine_terrorism": []}, "terrorism_rates": {}}', 'columns_mapping_link': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/AXA/column_mapping.json', 'columns_mapping': '[["Name", "Original Name"], ["column_1", "Total Premium"], ["column_2", "Total Commission"], ["column_3", "IPT"]]', 'scheme': 'W Denis Custodian Office', 'column_1': '[150, 150, 564]', 'policy_name': '["W Denis Custodian Office", "W Denis Custodian Office", "W Denis Custodian Office"]', 'policy_number': '["6930677", "6930677", "6930677"]', 'column_2': '[55.5, 55.5, 208.68]', 'column_3': '[18.0, 18.0, 67.68]', 'ipt_pct': '[0.12, 0.12, 0.12]'}, {'Filename': 'Carrier-AXA Risk-DO Cover-DO | BDX May w_denis.xlsx', 'month_year': '[5, 2023]', 'excel_file_path': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/s1_map_udf/Carrier-AXA Risk-DO Cover-DO | BDX May w_denis.xlsx', 'bdx_type': 'w_denis_custodian_mlp', '__config': '{"scheme": "W Denis Custodian", "i90_policy_name": "W Denis Custodian", "lead_underwriter": "Sabria T", "policy_number": "6834231", "read_excel": {"skiprows": [], "merge_rows": {}, "tolerance_nan_count": 23, "primary_columns": ["Posted Date"], "target_header_values": ["Total Premium"]}, "columns_mapping": {"column_1": "Total Premium", "column_2": "Total Commission", "column_3": "IPT"}, "validations": {"ipt_pct": {"field": "ipt_pct", "type": "formula", "formula": "column_3/column_1", "allowed_values": [0, 0.12], "tolerance": 0.002, "error_message": "IPT Validations has failed as percentage does not equal 0 % or 12 %"}, "policy_number": {"field": "policy_number", "type": "value_in_list", "allowed_values": ["6834231"], "error_message": "Following rows are invalid for  Policy Number"}, "commission_pct": {"field": "column_2", "type": "formula", "formula": "(column_2/column_1)*100", "comparison": "greater_than", "allowed_values": [37.0], "error_message": " Commission % is greater than 37% in the following rows"}}, "output_mapping": {"sum": ["column_1", "column_2"], "column_mapping_names": {"ipt_column_name": "ipt_pct", "policy_number": "policy_number"}, "transaction_dependant": [], "seperate_values_columns": [], "formulas": {"commission_pct": "(column_2/column_1)*100"}, "mapping": {"column_1": ["AN"], "column_2": ["AM"], "commission_pct": ["AL"]}, "custom_formulas": {}, "combine_terrorism": []}, "terrorism_rates": {}}', 'columns_mapping_link': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/AXA/column_mapping.json', 'columns_mapping': '[["Name", "Original Name"], ["column_1", "Total Premium"], ["column_2", "Total Commission"], ["column_3", "IPT"]]', 'scheme': 'W Denis Custodian', 'column_1': '[3865, 828, 4000, 250]', 'policy_name': '["W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian"]', 'policy_number': '["6834231", "6834231", "6834231", "6834231"]', 'column_2': '[1430.05, 306.36, 1480.0, 92.5]', 'column_3': '[463.8, 99.36, 480.0, 30.0]', 'ipt_pct': '[0.12, 0.12, 0.12, 0.12]'}, {'Filename': 'Carrier-AXA Risk-EPL Cover-EPL | BDX May w_denis.xlsx', 'month_year': '[5, 2023]', 'excel_file_path': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/s1_map_udf/Carrier-AXA Risk-EPL Cover-EPL | BDX May w_denis.xlsx', 'bdx_type': 'w_denis_custodian_mlp', '__config': '{"scheme": "W Denis Custodian", "i90_policy_name": "W Denis Custodian", "lead_underwriter": "Sabria T", "policy_number": "6834231", "read_excel": {"skiprows": [], "merge_rows": {}, "tolerance_nan_count": 23, "primary_columns": ["Posted Date"], "target_header_values": ["Total Premium"]}, "columns_mapping": {"column_1": "Total Premium", "column_2": "Total Commission", "column_3": "IPT"}, "validations": {"ipt_pct": {"field": "ipt_pct", "type": "formula", "formula": "column_3/column_1", "allowed_values": [0, 0.12], "tolerance": 0.002, "error_message": "IPT Validations has failed as percentage does not equal 0 % or 12 %"}, "policy_number": {"field": "policy_number", "type": "value_in_list", "allowed_values": ["6834231"], "error_message": "Following rows are invalid for  Policy Number"}, "commission_pct": {"field": "column_2", "type": "formula", "formula": "(column_2/column_1)*100", "comparison": "greater_than", "allowed_values": [37.0], "error_message": " Commission % is greater than 37% in the following rows"}}, "output_mapping": {"sum": ["column_1", "column_2"], "column_mapping_names": {"ipt_column_name": "ipt_pct", "policy_number": "policy_number"}, "transaction_dependant": [], "seperate_values_columns": [], "formulas": {"commission_pct": "(column_2/column_1)*100"}, "mapping": {"column_1": ["AN"], "column_2": ["AM"], "commission_pct": ["AL"]}, "custom_formulas": {}, "combine_terrorism": []}, "terrorism_rates": {}}', 'columns_mapping_link': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/AXA/column_mapping.json', 'columns_mapping': '[["Name", "Original Name"], ["column_1", "Total Premium"], ["column_2", "Total Commission"], ["column_3", "IPT"]]', 'scheme': 'W Denis Custodian', 'column_1': '[-324.51, 201.0, 2429.42, 442.64]', 'policy_name': '["W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian"]', 'policy_number': '["6834231", "6834231", "6834231", "6834231"]', 'column_2': '[-120.07, 74.37, 898.89, 163.78]', 'column_3': '[-38.94, 24.12, 291.53, 53.12]', 'ipt_pct': '[0.12, 0.12, 0.12, 0.12]'}, {'Filename': 'Carrier-AXA Risk-ML- Cover-EPL | BDX May w_denis.xlsx', 'month_year': '[5, 2023]', 'excel_file_path': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/s1_map_udf/Carrier-AXA Risk-ML- Cover-EPL | BDX May w_denis.xlsx', 'bdx_type': 'w_denis_custodian_mlp', '__config': '{"scheme": "W Denis Custodian", "i90_policy_name": "W Denis Custodian", "lead_underwriter": "Sabria T", "policy_number": "6834231", "read_excel": {"skiprows": [], "merge_rows": {}, "tolerance_nan_count": 23, "primary_columns": ["Posted Date"], "target_header_values": ["Total Premium"]}, "columns_mapping": {"column_1": "Total Premium", "column_2": "Total Commission", "column_3": "IPT"}, "validations": {"ipt_pct": {"field": "ipt_pct", "type": "formula", "formula": "column_3/column_1", "allowed_values": [0, 0.12], "tolerance": 0.002, "error_message": "IPT Validations has failed as percentage does not equal 0 % or 12 %"}, "policy_number": {"field": "policy_number", "type": "value_in_list", "allowed_values": ["6834231"], "error_message": "Following rows are invalid for  Policy Number"}, "commission_pct": {"field": "column_2", "type": "formula", "formula": "(column_2/column_1)*100", "comparison": "greater_than", "allowed_values": [37.0], "error_message": " Commission % is greater than 37% in the following rows"}}, "output_mapping": {"sum": ["column_1", "column_2"], "column_mapping_names": {"ipt_column_name": "ipt_pct", "policy_number": "policy_number"}, "transaction_dependant": [], "seperate_values_columns": [], "formulas": {"commission_pct": "(column_2/column_1)*100"}, "mapping": {"column_1": ["AN"], "column_2": ["AM"], "commission_pct": ["AL"]}, "custom_formulas": {}, "combine_terrorism": []}, "terrorism_rates": {}}', 'columns_mapping_link': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/AXA/column_mapping.json', 'columns_mapping': '[["Name", "Original Name"], ["column_1", "Total Premium"], ["column_2", "Total Commission"], ["column_3", "IPT"]]', 'scheme': 'W Denis Custodian', 'column_1': '[750, 2150]', 'policy_name': '["W Denis Custodian", "W Denis Custodian"]', 'policy_number': '["6834231", "6834231"]', 'column_2': '[277.5, 795.5]', 'column_3': '[90, 258]', 'ipt_pct': '[0.12, 0.12]'}, {'Filename': 'Carrier-AXA Risk-ML- Cover-DO | BDX May w_denis.xlsx', 'month_year': '[5, 2023]', 'excel_file_path': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/s1_map_udf/Carrier-AXA Risk-ML- Cover-DO | BDX May w_denis.xlsx', 'bdx_type': 'w_denis_custodian_mlp', '__config': '{"scheme": "W Denis Custodian", "i90_policy_name": "W Denis Custodian", "lead_underwriter": "Sabria T", "policy_number": "6834231", "read_excel": {"skiprows": [], "merge_rows": {}, "tolerance_nan_count": 23, "primary_columns": ["Posted Date"], "target_header_values": ["Total Premium"]}, "columns_mapping": {"column_1": "Total Premium", "column_2": "Total Commission", "column_3": "IPT"}, "validations": {"ipt_pct": {"field": "ipt_pct", "type": "formula", "formula": "column_3/column_1", "allowed_values": [0, 0.12], "tolerance": 0.002, "error_message": "IPT Validations has failed as percentage does not equal 0 % or 12 %"}, "policy_number": {"field": "policy_number", "type": "value_in_list", "allowed_values": ["6834231"], "error_message": "Following rows are invalid for  Policy Number"}, "commission_pct": {"field": "column_2", "type": "formula", "formula": "(column_2/column_1)*100", "comparison": "greater_than", "allowed_values": [37.0], "error_message": " Commission % is greater than 37% in the following rows"}}, "output_mapping": {"sum": ["column_1", "column_2"], "column_mapping_names": {"ipt_column_name": "ipt_pct", "policy_number": "policy_number"}, "transaction_dependant": [], "seperate_values_columns": [], "formulas": {"commission_pct": "(column_2/column_1)*100"}, "mapping": {"column_1": ["AN"], "column_2": ["AM"], "commission_pct": ["AL"]}, "custom_formulas": {}, "combine_terrorism": []}, "terrorism_rates": {}}', 'columns_mapping_link': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/AXA/column_mapping.json', 'columns_mapping': '[["Name", "Original Name"], ["column_1", "Total Premium"], ["column_2", "Total Commission"], ["column_3", "IPT"]]', 'scheme': 'W Denis Custodian', 'column_1': '[1500, 1500]', 'policy_name': '["W Denis Custodian", "W Denis Custodian"]', 'policy_number': '["6834231", "6834231"]', 'column_2': '[555, 555]', 'column_3': '[180, 180]', 'ipt_pct': '[0.12, 0.12]'}, {'Filename': 'Carrier-AXA Risk-PI Cover-PI | BDX May w_denis.xlsx', 'month_year': '[5, 2023]', 'excel_file_path': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/s1_map_udf/Carrier-AXA Risk-PI Cover-PI | BDX May w_denis.xlsx', 'bdx_type': 'w_denis_custodian_pi', '__config': '{"scheme": "W Denis Custodian", "i90_policy_name": "W Denis Custodian", "lead_underwriter": "Sabria T", "policy_number": "6834231", "read_excel": {"skiprows": [], "merge_rows": {}, "tolerance_nan_count": 23, "primary_columns": ["Total Premium"], "target_header_values": ["Total Premium"]}, "columns_mapping": {"column_1": "Total Premium", "column_2": "Total Commission", "column_3": "IPT"}, "validations": {"ipt_pct": {"field": "ipt_pct", "type": "formula", "formula": "column_3/column_1", "allowed_values": [0, 0.12], "tolerance": 0.002, "error_message": "IPT Validations has failed as percentage does not equal 0 % or 12 %"}, "policy_number": {"field": "policy_number", "type": "value_in_list", "allowed_values": ["6834231"], "error_message": "Following rows are invalid for  Policy Number"}, "commission_pct": {"field": "column_2", "type": "formula", "formula": "(column_2/column_1)*100", "comparison": "greater_than", "allowed_values": [37.0], "error_message": " Commission % is greater than 37% in the following rows"}}, "output_mapping": {"sum": ["column_1", "column_2"], "column_mapping_names": {"ipt_column_name": "ipt_pct", "policy_number": "policy_number"}, "transaction_dependant": [], "seperate_values_columns": [], "formulas": {"commission_pct": "(column_2/column_1)*100"}, "mapping": {"column_1": ["AK"], "column_2": ["AJ"], "commission_pct": ["AI"]}, "custom_formulas": {}, "combine_terrorism": []}, "terrorism_rates": {}}', 'columns_mapping_link': 'https://axa-uk.dev.instabase.com/IB-INTERNALS/BDX-Solution-Pramod/fs/azure-blob/Solution/out_main/out_custodian_office_kedar/AXA/column_mapping.json', 'columns_mapping': '[["Name", "Original Name"], ["column_1", "Total Premium"], ["column_2", "Total Commission"], ["column_3", "IPT"]]', 'scheme': 'W Denis Custodian', 'column_1': '[2880.0, 24750.0, 0.0, 0.0, 825.0, 600.0, 5000.0, 0.0, 4200.0, -802.19, -1704.92, 0.0, 1000.0, -350.0, 1050.0, 0.0, 0.0, 5250.0, 750.0, 12000.0, 1700.0, 3305.0, 360.0, 900.0, 1995.0, 750.0, 1250.0, 3500.0, 12053.28, 0.0, 225.0, 4350.0, 13000.0, 1000.0, 0.0, 2000.0, 5500.0, 3275.0, 9750.0, -500.0, 11075.0, 720.0, 12500.0, 0.0]', 'policy_name': '["W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian", "W Denis Custodian"]', 'policy_number': '["6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231", "6834231"]', 'column_2': '[1065.6, 9157.5, 0.0, 0.0, 305.25, 222.0, 1850.0, 0.0, 1554.0, -296.81, -630.82, 0.0, 370.0, -129.5, 388.5, 0.0, 0.0, 1942.5, 277.5, 4440.0, 629.0, 1222.85, 133.2, 333.0, 738.15, 277.5, 462.5, 1295.0, 4459.71, 0.0, 83.25, 1609.5, 4810.0, 370.0, 0.0, 740.0, 2035.0, 1211.75, 3607.5, -185.0, 3431.04, 266.4, 4625.0, 0.0]', 'column_3': '[345.6, 2970.0, 0.0, 0.0, 99.0, 72.0, 600.0, 0.0, 504.0, -96.26, -204.59, 0.0, 120.0, -42.0, 126.0, 0.0, 0.0, 630.0, 90.0, 1440.0, 204.0, 396.6, 43.2, 108.0, 239.4, 90.0, 150.0, 420.0, 1446.39, 0.0, 27.0, 522.0, 1560.0, 120.0, 0.0, 240.0, 660.0, 393.0, 1170.0, -60.0, 1329.0, 86.4, 1500.0, 0.0]', 'ipt_pct': '[0.12, 0.12, 0, 0, 0.12, 0.12, 0.12, 0, 0.12, 0.12, 0.12, 0, 0.12, 0.12, 0.12, 0, 0, 0.12, 0.12, 0.12, 0.12, 0.12, 0.12, 0.12, 0.12, 0.12, 0.12, 0.12, 0.12, 0, 0.12, 0.12, 0.12, 0.12, 0, 0.12, 0.12, 0.12, 0.12, 0.12, 0.12, 0.12, 0.12, 0]'}]


def merge_dicts(dicts):
    for i in dicts:
        i['policy_name'] = eval(i['policy_name'])
        i['policy_number'] = eval(i['policy_number'])
        i['ipt_pct'] = eval(i['ipt_pct'])
    merged_dict = defaultdict(lambda: {'Filename': '', 'month_year': '', 'excel_file_path': '', 'bdx_type': [],
                                       '__config': [], 'columns_mapping_link': '', 'columns_mapping': '',
                                       'column_1': [], 'column_2': [], 'column_3': [], 'ipt_pct': []})

    for d in dicts:
        key = (d['scheme'], d['policy_name'][0], d['policy_number'][0], d['ipt_pct'][0])
        merged_dict[key]['Filename'] = d['Filename'] # add all filenames together
        merged_dict[key]['month_year'] = d['month_year']
        merged_dict[key]['excel_file_path'] = d['excel_file_path']
        merged_dict[key]['bdx_type'].append(d['bdx_type'])
        merged_dict[key]['__config'].append(d['__config'])
        merged_dict[key]['columns_mapping_link'] = d['columns_mapping_link']
        merged_dict[key]['columns_mapping'] = d['columns_mapping']
        merged_dict[key]['column_1'].extend(eval(d['column_1']))
        merged_dict[key]['column_2'].extend(eval(d['column_2']))
        merged_dict[key]['column_3'].extend(eval(d['column_3']))
        merged_dict[key]['ipt_pct'].extend(d['ipt_pct'])

    result = []

    for key, values in merged_dict.items():
        result.append({
            'Filename': str(values['Filename']),
            'month_year': str(values['month_year']),
            'excel_file_path': str(values['excel_file_path']),
            'bdx_type': str(values['bdx_type']),
            '__config': str(values['__config']),
            'columns_mapping_link': str(values['columns_mapping_link']),
            'columns_mapping': str(values['columns_mapping']),
            'scheme': key[0],
            'column_1': str(values['column_1']),
            'policy_name': str([key[1]]),
            'policy_number': str([key[2]]),
            'column_2': str(values['column_2']),
            'column_3': str(values['column_3']),
            'ipt_pct': str(values['ipt_pct']),
        })
    return result


# Example usage
merged_result = merge_dicts(a)

for merged_item in merged_result:
    print(merged_item)

# print(a[0].keys())
